<h1 class='text-2xl font-bold mb-6'>
  Danh sách đơn hàng
</h1>

<div id='orders-list' class='space-y-6'>
  {{#each orders}}
    <div
      class='flex flex-col md:flex-row gap-4 p-4 border rounded shadow-sm bg-white'
    >
      <!-- Hình ảnh sản phẩm đại diện -->
      <img
        src="{{this.order_Item.0.product_id.image_url}}"
        alt=''
        class='w-48 h-48 object-cover rounded border'
      />

      <!-- Thông tin đơn hàng -->
      <div class='flex-1 space-y-2'>
        <p>
          <strong>
            Mã đơn hàng:
          </strong>
          {{this._id}}
        </p>
        <p>
          <strong>
            Tổng giá trị:
          </strong>
          {{formatCurrency this.total}}
        </p>
        <p>
          <strong>
            Trạng thái:
          </strong>
          {{this.status}}
        </p>
        <p>
          <strong>
            Ngày tạo:
          </strong>
          {{formatDate this.created_at}}
        </p>

        <ul class='list-disc list-inside text-sm text-gray-700 space-y-1'>
          {{#each this.order_Item}}
            <li>
              {{this.product_id.name}} - Số lượng: {{this.quantity}} - Giá tiền:
              <span class='text-red-600 font-semibold'>
                {{formatCurrency this.product_id.price}}
              </span>
            </li>
          {{/each}}
        </ul>
      </div>

      <!-- Đánh giá nếu đã hoàn thành -->
      {{#ifEquals this.status 'Đã hoàn thành'}}
        <div class='mt-4 md:mt-0 md:ml-6 w-full md:w-1/3'>
          <form
            class='ratingForm space-y-4'
            onsubmit="ratingFormSubmit(event, '{{this._id}}')"
          >
            <div>
              {{#each this.order_Item}}
                <input
                  type='hidden'
                  class="productId-{{this.order_id}}"
                  value="{{this.product_id._id}}"
                />
              {{/each}}

              <div
                class='flex justify-between text-yellow-500 text-xl mb-2'
                id="rating-{{this._id}}"
              >
                <input
                  type='radio'
                  id="star-{{this._id}}-5"
                  name='rating'
                  value='5'
                  hidden
                />
                <label for="star-{{this._id}}-5" class='cursor-pointer'>
                  <i class='fas fa-star'></i>
                </label>

                <input
                  type='radio'
                  id="star-{{this._id}}-4"
                  name='rating'
                  value='4'
                  hidden
                />
                <label for="star-{{this._id}}-4" class='cursor-pointer'>
                  <i class='fas fa-star'></i>
                </label>

                <input
                  type='radio'
                  id="star-{{this._id}}-3"
                  name='rating'
                  value='3'
                  hidden
                />
                <label for="star-{{this._id}}-3" class='cursor-pointer'>
                  <i class='fas fa-star'></i>
                </label>

                <input
                  type='radio'
                  id="star-{{this._id}}-2"
                  name='rating'
                  value='2'
                  hidden
                />
                <label for="star-{{this._id}}-2" class='cursor-pointer'>
                  <i class='fas fa-star'></i>
                </label>

                <input
                  type='radio'
                  id="star-{{this._id}}-1"
                  name='rating'
                  value='1'
                  hidden
                />
                <label for="star-{{this._id}}-1" class='cursor-pointer'>
                  <i class='fas fa-star'></i>
                </label>
              </div>

              <button
                type='submit'
                class='w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition duration-200'
              >
                Đánh giá
              </button>
            </div>

            <div>
              <label
                for="comment-{{this._id}}"
                class='block text-sm font-medium text-gray-700 mb-1'
              >
                Bình luận
              </label>
              <input
                type='text'
                id="comment-{{this._id}}"
                name='comment'
                placeholder='Comment'
                class='w-full border rounded px-3 py-2 text-sm focus:outline-none focus:ring focus:ring-blue-300'
              />
            </div>
          </form>
        </div>
      {{/ifEquals}}
    </div>
  {{/each}}
</div>